(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     23594,        599]
NotebookOptionsPosition[     21924,        571]
NotebookOutlinePosition[     22317,        587]
CellTagsIndexPosition[     22274,        584]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"General", "::", "stop"}], "]"}], ";"}],
  FontWeight->"Plain"], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{"Off", "[", 
    RowBox[{"CompiledFunction", "::", "cfsa"}], "]"}],
   FontWeight->"Plain"], ";"}], "\n", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"h", " ", "=", " ", "0.2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "h"}], " ", "-", " ", "1"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.940308863318228*^9, 3.9403088646324177`*^9}, {
   3.940308928337062*^9, 3.94030892891735*^9}, 3.940309159184547*^9, {
   3.940309475742392*^9, 3.940309479891347*^9}, {3.940373567517226*^9, 
   3.940373571734763*^9}, 3.940376506312997*^9, 3.940401470407544*^9, {
   3.940407467788468*^9, 3.94040746784199*^9}, {3.940411871452754*^9, 
   3.940411872181707*^9}, {3.94042381891556*^9, 3.940423840127808*^9}, 
   3.9404242676643553`*^9, 3.940424455111219*^9, {3.9404245916849318`*^9, 
   3.940424593344881*^9}, {3.94042467923025*^9, 3.940424684946578*^9}, {
   3.947772678184824*^9, 3.9477726783011427`*^9}, 3.9477735667676697`*^9, 
   3.947773618685129*^9, {3.947777923038411*^9, 3.947777923382564*^9}, 
   3.947778058736225*^9, 3.947778321928726*^9, 3.947778489287335*^9},
 CellLabel->
  "In[217]:=",ExpressionUUID->"a534b6b3-1d53-40a0-9fd4-bebf8a50c068"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fc", " ", ":=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "_Real"}], "}"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "^", 
         RowBox[{"(", 
          RowBox[{"3", "-", "alpha"}], ")"}]}], " ", "-", " ", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"3", "-", "alpha"}], ")"}], "x"}], " ", "-", " ", "1"}], 
       ")"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{"3", "-", "alpha"}], ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"fc", "[", "0.1", "]"}], "*)"}]}]}], "Code",
 CellChangeTimes->{{3.940308916630349*^9, 3.940308950445054*^9}, {
   3.9403768028335876`*^9, 3.940376837528522*^9}, {3.9403774012003813`*^9, 
   3.940377406241817*^9}, {3.940377462048423*^9, 3.940377478449152*^9}, {
   3.940377609095372*^9, 3.940377644559271*^9}, {3.9403777865397587`*^9, 
   3.940377799246464*^9}, 3.940400086839551*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"4b271c92-e276-43d9-aa0c-94adc3617c62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
   RowBox[{"fc", "[", "x", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"f", "[", "0.1", "]"}], "*)"}]}]}], "Code",
 CellChangeTimes->{3.9403777912765903`*^9, 3.940400089021696*^9},
 CellLabel->
  "In[223]:=",ExpressionUUID->"3b83fa7d-9945-4db9-add0-8a8180681f4f"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Code",
 CellChangeTimes->{{3.9403834878264427`*^9, 3.940383512373056*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"1bebf858-b9bd-40d1-bc3b-8e2e199f48d6"],

Cell[BoxData[
 RowBox[{"uexact", " ", ":=", " ", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "_Real"}], "}"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "^", 
        RowBox[{"(", 
         RowBox[{"3", "-", "alpha"}], ")"}]}], " ", "-", " ", "1"}], ")"}], 
     " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"3", "-", "alpha"}], ")"}]}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.940309028161727*^9, 3.940309080873884*^9}, 
   3.940309207552381*^9, 3.9403765225963097`*^9, {3.940376839755598*^9, 
   3.940376848440559*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"fa4772a9-17c1-4177-8050-ca5106b1b461"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wc", " ", ":=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "_Real"}], "}"}], "}"}], ",", " ", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "   ", 
           RowBox[{"0", "<=", "x", "<", "1"}]}], "}"}], ",", "\n", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "-", "x"}], ",", " ", 
           RowBox[{"1", "<=", "x", "<=", "2"}]}], "}"}]}], "\n", "}"}], ",", 
       " ", "0"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
   RowBox[{"wc", "[", "x", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"w", "[", "0.05", "]"}], ";"}], "\n", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"w", "[", "x", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "Code",
 CellChangeTimes->{{3.9403090874885197`*^9, 3.9403090911015053`*^9}, {
  3.940309211510503*^9, 3.940309220269162*^9}, {3.940309342779167*^9, 
  3.9403093814581757`*^9}, {3.9403094180462723`*^9, 3.940309419765291*^9}, {
  3.940376851624308*^9, 3.940376870825979*^9}, {3.94037791181001*^9, 
  3.940377947179582*^9}, {3.9403864766532097`*^9, 3.940386485338553*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"adac08b3-c9dc-4390-9bcf-21c098c857df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phiCompiled", " ", "=", " ", 
   RowBox[{"Table", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", " ", "=", " ", "j"}], "}"}], ",", " ", "\n", "    ", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "_Real"}], "}"}], "}"}], ",", " ", 
         RowBox[{"w", "[", 
          RowBox[{
           RowBox[{"x", "/", "h"}], " ", "-", " ", "j"}], "]"}]}], "]"}]}], 
      "\n", "  ", "]"}], ",", " ", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"Table", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", " ", "=", " ", "i"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"phiCompiled", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", "#", "]"}], " ", "&"}]}], 
      "]"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", "phiCompiled", "]"}]}], "}"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"phi", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "[", "x", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}]}], "Code",
 CellChangeTimes->{{3.94030943742933*^9, 3.9403094967902813`*^9}, {
   3.940374565851964*^9, 3.940374571820653*^9}, {3.940374812141932*^9, 
   3.940374812720458*^9}, {3.9403748442647877`*^9, 3.9403748530770473`*^9}, {
   3.940374907136335*^9, 3.9403749187557507`*^9}, {3.940375197095561*^9, 
   3.940375200842654*^9}, {3.940375314815792*^9, 3.9403753151642857`*^9}, {
   3.9403753784577417`*^9, 3.940375406688217*^9}, {3.940375462143197*^9, 
   3.940375518942378*^9}, {3.940375698122203*^9, 3.940375709619166*^9}, {
   3.9403771951290913`*^9, 3.9403772023835573`*^9}, {3.940378849524543*^9, 
   3.940378851719445*^9}, {3.940379056075759*^9, 3.9403790927461433`*^9}, {
   3.94037921904071*^9, 3.940379240196151*^9}, {3.940379316388215*^9, 
   3.940379348690641*^9}, {3.940386506478961*^9, 3.94038650677669*^9}, {
   3.9403865528925953`*^9, 3.940386581752181*^9}, {3.9403988492594023`*^9, 
   3.940398880840085*^9}, {3.940399022097715*^9, 3.940399069270545*^9}, {
   3.940399160823897*^9, 3.940399170239558*^9}, 3.940423855028784*^9, {
   3.947772758439069*^9, 3.947772767323598*^9}, {3.947772800906065*^9, 
   3.9477728137935867`*^9}, {3.947772933885894*^9, 3.947772947275778*^9}, {
   3.9477730016829853`*^9, 3.9477730302069283`*^9}, {3.947773076723363*^9, 
   3.947773085170043*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"9764256f-fc07-46c6-b2cd-389337122c35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phiD", " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", " ", "=", " ", "j"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", "\n", "    ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "h"}], ",", " ", 
              RowBox[{
               RowBox[{"h", " ", "*", " ", "j"}], " ", "<=", " ", "#", " ", 
               "<", " ", 
               RowBox[{"h", " ", "*", " ", 
                RowBox[{"(", 
                 RowBox[{"j", "+", "1"}], ")"}]}]}]}], "}"}], ",", "\n", 
            "    ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "h"}], ",", " ", 
              RowBox[{
               RowBox[{"h", " ", "*", " ", 
                RowBox[{"(", 
                 RowBox[{"j", "+", "1"}], ")"}]}], " ", "<=", " ", "#", " ", "<=",
                " ", 
               RowBox[{"h", " ", "*", " ", 
                RowBox[{"(", 
                 RowBox[{"j", "+", "2"}], ")"}]}]}]}], "}"}]}], "\n", "}"}], 
          ",", " ", "0"}], "]"}], "&"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"phiD", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "[", "x", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "0", ",", "1"}], "}"}]}], "]"}]}], "Code",
 CellChangeTimes->{{3.940378937603204*^9, 3.9403789904704733`*^9}, {
   3.940401604500326*^9, 3.940401604901395*^9}, {3.940407247577252*^9, 
   3.9404072868982286`*^9}, {3.9404073280985107`*^9, 3.940407329176379*^9}, {
   3.94040736876862*^9, 3.940407388474127*^9}, {3.9404075956900187`*^9, 
   3.940407597943841*^9}, {3.940407642236442*^9, 3.9404077008287573`*^9}, {
   3.9404077353789053`*^9, 3.9404077593157387`*^9}, {3.940407796141492*^9, 
   3.9404077993561773`*^9}, {3.940407868076432*^9, 3.940407946391626*^9}, {
   3.940423873592456*^9, 3.9404238741350327`*^9}, {3.947772717830914*^9, 
   3.947772723231862*^9}, 3.947773159132049*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"050ffe3e-1642-49bb-9132-a7c829ad5204"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fj", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"NIntegrate", "[", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], " ", "*", " ", 
        RowBox[{
         RowBox[{"phi", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"h", "*", "j"}]}], "]"}], ",", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"1", ",", 
           RowBox[{"h", "*", 
            RowBox[{"(", 
             RowBox[{"j", "+", "2"}], ")"}]}]}], "]"}]}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{"WorkingPrecision", " ", "->", " ", "32"}], ",", " ", 
       RowBox[{"PrecisionGoal", " ", "->", " ", "8"}], ",", " ", "\n", "    ", 
       RowBox[{"MaxRecursion", " ", "->", " ", "20"}], ",", " ", 
       RowBox[{"AccuracyGoal", " ", "->", " ", "8"}], ",", "\n", "    ", 
       RowBox[{"Method", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", " ", 
          RowBox[{"\"\<SymbolicProcessing\>\"", " ", "->", " ", "0"}]}], 
         "}"}]}]}], "\n", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.940309501619371*^9, 3.940309552855481*^9}, {
   3.9403095935761003`*^9, 3.9403095987583513`*^9}, {3.940309634486437*^9, 
   3.940309646518948*^9}, {3.940373763765576*^9, 3.940373777581277*^9}, {
   3.94037573461979*^9, 3.940375752093586*^9}, 3.940376897650014*^9, {
   3.940378032531529*^9, 3.940378043198154*^9}, {3.9403780738866*^9, 
   3.940378133748558*^9}, {3.9403790110578947`*^9, 3.940379011155674*^9}, {
   3.94039923069377*^9, 3.9403992518780212`*^9}, {3.940401142152109*^9, 
   3.940401144712929*^9}, {3.9404247493245087`*^9, 3.940424751424053*^9}, {
   3.947773284484795*^9, 3.947773285381482*^9}, 3.9477734378790493`*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"5d69e5e0-5f95-4cdb-99e3-335ac8681aac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", " ", ":=", " ", 
   RowBox[{"ParallelTable", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"NIntegrate", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "^", "alpha"}], " ", "*", " ", 
         RowBox[{
          RowBox[{"phiD", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}], " ", "*", 
         " ", 
         RowBox[{
          RowBox[{"phiD", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}]}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}], " ", "*", 
         " ", 
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}]}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"h", "*", "j"}]}], "]"}], ",", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"1", ",", 
           RowBox[{"h", "*", 
            RowBox[{"(", 
             RowBox[{"j", "+", "2"}], ")"}]}]}], "]"}]}], "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"WorkingPrecision", " ", "->", " ", "16"}], ",", " ", 
       RowBox[{"PrecisionGoal", " ", "->", " ", "8"}], ",", " ", "\n", 
       "        ", 
       RowBox[{"MaxRecursion", " ", "->", " ", "20"}], ",", " ", 
       RowBox[{"AccuracyGoal", " ", "->", " ", "8"}]}], "\n", "\t", "]"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.94039953646316*^9, 3.940399616936679*^9}, {
  3.940399843578332*^9, 3.940399843918343*^9}, {3.940423915018694*^9, 
  3.940423918280849*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"6fc89f20-4459-4f38-80a7-7675fc4f6322"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tt", " ", ":=", " ", 
   RowBox[{"ParallelTable", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"NIntegrate", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "^", "alpha"}], " ", "*", " ", 
         RowBox[{
          RowBox[{"phiD", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", "x", "]"}], " ", "*", 
         " ", 
         RowBox[{
          RowBox[{"phiD", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}]}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", "x", "]"}], " ", "*", 
         " ", 
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "2"}], "]"}], "]"}], "[", "x", "]"}]}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", 
           RowBox[{"h", "*", "j"}]}], "]"}], ",", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"1", ",", 
           RowBox[{"h", "*", 
            RowBox[{"(", 
             RowBox[{"j", "+", "2"}], ")"}]}]}], "]"}]}], "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"WorkingPrecision", " ", "->", " ", "16"}], ",", " ", 
       RowBox[{"PrecisionGoal", " ", "->", " ", "8"}], ",", " ", "\n", 
       "        ", 
       RowBox[{"MaxRecursion", " ", "->", " ", "20"}], ",", " ", 
       RowBox[{"AccuracyGoal", " ", "->", " ", "8"}]}], "\n", "\t", "]"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "0", ",", " ", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.940399662684759*^9, 3.940399678835589*^9}, {
  3.9403998316728354`*^9, 3.940399836776279*^9}, {3.940423920923616*^9, 
  3.940423922398262*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"8364f12d-4323-4b64-8c2b-6ea62c9dec33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", ":=", " ", 
   RowBox[{"Length", "[", "t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"systemcoef", " ", "=", " ", 
   RowBox[{"SparseArray", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t    ", 
      RowBox[{
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], "]"}], " ", "->", " ", "t"}], 
       ",", "        ", 
       RowBox[{"(*", " ", 
        RowBox[{"Main", " ", "diagonal"}], " ", "*)"}], "\n", "\t    ", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", " ", "1"}], "}"}], "]"}], " ", "->", " ", "tt"}], 
       ",", "       ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Subdiagonal", " ", "below", " ", "the", " ", "main", " ", 
         "diagonal"}], " ", "*)"}], "\n", "\t    ", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "2"}], "}"}], "]"}], " ", "->", " ", 
        "tt"}]}], "        ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Subdiagonal", " ", "above", " ", "the", " ", "main", " ", 
        "diagonal"}], " ", "*)"}], "\n", "\t", "}"}], ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "k"}], "}"}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9403118725478363`*^9, 3.940311893651642*^9}, {
   3.940312060573222*^9, 3.9403120717974453`*^9}, {3.940375027984034*^9, 
   3.940375086851623*^9}, {3.9403751223067636`*^9, 3.940375150046686*^9}, {
   3.940375780143471*^9, 3.9403757847026978`*^9}, {3.9403758797802563`*^9, 
   3.940375962585561*^9}, {3.9403763210635643`*^9, 3.940376322163727*^9}, {
   3.940379393642905*^9, 3.940379393773295*^9}, {3.940399794831162*^9, 
   3.94039981817994*^9}, {3.940399859448694*^9, 3.940399875797044*^9}, 
   3.94777343323409*^9},
 CellLabel->
  "In[238]:=",ExpressionUUID->"ffd7ab36-3c58-4952-b31a-f321a0d75ad4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", " ", ":=", " ", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"systemcoef", ",", " ", "fj"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", "a", "]"}]}], "Code",
 CellChangeTimes->{{3.940373744753729*^9, 3.940373755967115*^9}, {
  3.940375995859117*^9, 3.940375997098871*^9}, {3.940376544748786*^9, 
  3.940376545571249*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"9e82d948-2519-4da2-8e49-fa993dfa4620"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"approx", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "2"}], "]"}], "]"}], " ", "*", " ", 
       RowBox[{"w", "[", 
        RowBox[{
         RowBox[{"x", "/", "h"}], " ", "-", " ", "i"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", 
        RowBox[{"-", "1"}], ",", " ", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], "*)"}]], "Code",
 CellChangeTimes->{{3.940376078697219*^9, 3.9403761122540703`*^9}, {
   3.940399974876787*^9, 3.94039997795371*^9}, {3.940400031179452*^9, 
   3.940400042711383*^9}, {3.940403601597569*^9, 3.940403611694887*^9}, {
   3.94041190043583*^9, 3.9404119007568893`*^9}, {3.940424468395678*^9, 
   3.940424471298273*^9}, 3.94777352201283*^9, {3.947777937975505*^9, 
   3.9477779404286737`*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"4308db3c-ca06-4603-b072-94c4cdca09bf"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"uexact", "[", "x", "]"}], ",", " ", 
      RowBox[{"approx", "[", "x", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", "\n", "  ", 
    RowBox[{"PlotStyle", " ", "->", " ", 
     RowBox[{"{", 
      RowBox[{"Red", ",", " ", "Blue"}], "}"}]}], ",", " ", "\n", "  ", 
    RowBox[{"PlotLegends", " ", "->", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<exact\>\"", ",", " ", "\"\<approx\>\""}], "}"}]}]}], "]"}],
   "*)"}]], "Code",
 CellChangeTimes->{{3.940376136959025*^9, 3.9403761374057207`*^9}, {
   3.940376170618258*^9, 3.940376195929503*^9}, 3.9404244729979258`*^9, {
   3.94777352415131*^9, 3.94777353343784*^9}, 3.947777942055962*^9},
 CellLabel->
  "In[243]:=",ExpressionUUID->"48e52d70-464a-4494-b203-1f51f641c21f"]
},
WindowSize->{1728, 1051},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0a2bb75a-a6e1-4054-8062-ecffea7a4292"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 1410, 31, 126, "Code",ExpressionUUID->"a534b6b3-1d53-40a0-9fd4-bebf8a50c068"],
Cell[1967, 53, 1114, 29, 69, "Code",ExpressionUUID->"4b271c92-e276-43d9-aa0c-94adc3617c62"],
Cell[3084, 84, 399, 11, 69, "Code",ExpressionUUID->"3b83fa7d-9945-4db9-add0-8a8180681f4f"],
Cell[3486, 97, 318, 8, 51, "Code",ExpressionUUID->"1bebf858-b9bd-40d1-bc3b-8e2e199f48d6"],
Cell[3807, 107, 715, 20, 51, "Code",ExpressionUUID->"fa4772a9-17c1-4177-8050-ca5106b1b461"],
Cell[4525, 129, 1470, 38, 164, "Code",ExpressionUUID->"adac08b3-c9dc-4390-9bcf-21c098c857df"],
Cell[5998, 169, 2920, 66, 258, "Code",ExpressionUUID->"9764256f-fc07-46c6-b2cd-389337122c35"],
Cell[8921, 237, 2399, 58, 126, "Code",ExpressionUUID->"050ffe3e-1642-49bb-9132-a7c829ad5204"],
Cell[11323, 297, 2164, 47, 145, "Code",ExpressionUUID->"5d69e5e0-5f95-4cdb-99e3-335ac8681aac"],
Cell[13490, 346, 2055, 56, 164, "Code",ExpressionUUID->"6fc89f20-4459-4f38-80a7-7675fc4f6322"],
Cell[15548, 404, 2036, 55, 164, "Code",ExpressionUUID->"8364f12d-4323-4b64-8c2b-6ea62c9dec33"],
Cell[17587, 461, 1947, 46, 201, "Code",ExpressionUUID->"ffd7ab36-3c58-4952-b31a-f321a0d75ad4"],
Cell[19537, 509, 447, 10, 69, "Code",ExpressionUUID->"9e82d948-2519-4da2-8e49-fa993dfa4620"],
Cell[19987, 521, 1031, 25, 51, "Code",ExpressionUUID->"4308db3c-ca06-4603-b072-94c4cdca09bf"],
Cell[21021, 548, 899, 21, 88, "Code",ExpressionUUID->"48e52d70-464a-4494-b203-1f51f641c21f"]
}
]
*)

